(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{385:function(e,t,r){},398:function(e,t,r){"use strict";var a=r(385);r.n(a).a},412:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"new-reviews"},[r("div",{staticClass:"admin-block"},[e._m(0),r("div",{staticClass:"admin-block__content"},[r("div",{staticClass:"new-reviews__form"},[r("form",[r("div",{staticClass:"new-reviews__form-content"},[r("div",{staticClass:"new-reviews__left"},[r("div",{staticClass:"avatar avatar_empty new-reviews__avatar",class:{filled:this.renderedPhoto.length},style:{backgroundImage:"url("+this.renderedPhoto+")"}}),r("div",{staticClass:"form__input-container"},[r("label",{staticClass:"admin-add"},[r("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|image|size:1500",expression:"'required|image|size:1500'"}],staticClass:"form__file-input",attrs:{type:"file",name:"photo"},on:{change:function(t){return e.appendFile(t)}}}),e._v("Добавить фото")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("photo"),expression:"errors.has('photo')"}],staticClass:"form__error"},[e._v(e._s(e.errors.first("photo")))])])]),r("div",{staticClass:"new-reviews__right"},[r("div",{staticClass:"form__row"},[r("div",{staticClass:"form__col"},[r("div",{staticClass:"form__group",class:{form__group_error:e.errors.has("author")}},[r("label",{staticClass:"form__label"},[e._v("Имя автора")]),r("div",{staticClass:"form__input-container"},[r("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:100",expression:"'required|max:100'"},{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"form__input",attrs:{name:"author",type:"text"},domProps:{value:e.review.author},on:{input:function(t){t.target.composing||e.$set(e.review,"author",t.target.value)}}})]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("author"),expression:"errors.has('author')"}],staticClass:"form__error"},[e._v(e._s(e.errors.first("author")))])])]),r("div",{staticClass:"form__col"},[r("div",{staticClass:"form__group",class:{form__group_error:e.errors.has("occ")}},[r("label",{staticClass:"form__label"},[e._v("Титул автора")]),r("div",{staticClass:"form__input-container"},[r("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:50",expression:"'required|max:50'"},{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"form__input",attrs:{name:"occ",type:"text"},domProps:{value:e.review.occ},on:{input:function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)}}})]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("occ"),expression:"errors.has('occ')"}],staticClass:"form__error"},[e._v(e._s(e.errors.first("occ")))])])])]),r("div",{staticClass:"form__row"},[r("div",{staticClass:"form__col"},[r("div",{staticClass:"form__group",class:{form__group_error:e.errors.has("text")}},[r("label",{staticClass:"form__label"},[e._v("Отзыв")]),r("div",{staticClass:"form__input-container"},[r("textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"form__input form__input_text",attrs:{name:"text"},domProps:{value:e.review.text},on:{input:function(t){t.target.composing||e.$set(e.review,"text",t.target.value)}}})]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("text"),expression:"errors.has('text')"}],staticClass:"form__error"},[e._v(e._s(e.errors.first("text")))])])])]),r("div",{staticClass:"form__row"},[r("div",{staticClass:"form__col new-reviews__controls"},[r("button",{staticClass:"admin-btn admin-btn_empty",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("hideFormReview")}}},[e._v("Отмена")]),r("button",{staticClass:"admin-btn",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.validateForm(t)}}},[e._v("Сохранить")])])])])])])])])])])};a._withStripped=!0;var s=r(96);function i(e,t,r,a,s,i,o){try{var n=e[i](o),c=n.value}catch(e){return void r(e)}n.done?t(c):Promise.resolve(c).then(a,s)}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){n(e,t,r[t])})}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c={data:function(){return{dataRenderedPhoto:""}},computed:o({},Object(s.d)("reviews",{review:function(e){return e.editedReview}}),{renderedPhoto:{get:function(){return this.review.id&&!this.dataRenderedPhoto?"https://webdev-api.loftschool.com/".concat(this.review.photo):this.dataRenderedPhoto},set:function(e){this.dataRenderedPhoto=e}}}),methods:o({},Object(s.b)("reviews",["addReview","editReview"]),Object(s.c)("reviews",["SET_EDITED_REVIEW"]),Object(s.b)("errors",["setError"]),{appendFile:function(e){var t=this;this.$validator.validate("photo").then(function(r){var a=e.target.files[0],s=new FileReader;if(t.review.photo=a,r)try{s.readAsDataURL(a),s.onload=function(){t.renderedPhoto=s.result}}catch(e){t.setError({message:e,type:"error"})}})},validateForm:function(){var e=this;this.review.id&&this.review.photo&&this.$validator.detach("photo"),this.$validator.validate().then(function(t){t&&e.saveReview()})},saveReview:function(){var e,t=(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.review.id){e.next=5;break}this.editReview(this.review),e.next=7;break;case 5:return e.next=7,this.addReview(this.review);case 7:this.setError({message:this.review.id?"Отзыв изменен":"Отзыв добавлен",type:"success"}),this.SET_EDITED_REVIEW({}),this.renderedPhoto="",this.$validator.reset(),this.$emit("hideFormReview"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),this.setError({message:e.t0,type:"error"});case 17:case"end":return e.stop()}},e,this,[[0,14]])}),function(){var t=this,r=arguments;return new Promise(function(a,s){var o=e.apply(t,r);function n(e){i(o,a,s,n,c,"next",e)}function c(e){i(o,a,s,n,c,"throw",e)}n(void 0)})});return function(){return t.apply(this,arguments)}}()})},v=(r(398),r(51)),l=Object(v.a)(c,a,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"admin-block__header"},[t("h2",{staticClass:"new-reviews__title"},[this._v("Новый отзыв")])])}],!1,null,"666575ba",null);l.options.__file="src/admin/components/reviews/reviews-form.vue";t.default=l.exports}}]);